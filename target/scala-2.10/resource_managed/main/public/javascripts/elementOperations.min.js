var module$elementOperations={};removeetype=false;displayOptions=function(){$("#addFromTypeahead").css("display","");var leftpos=$("#content-search").position().left;var toppos=$("#content-search").position().top-30;$("#addFromTypeahead").css("left",leftpos+"px");$("#addFromTypeahead").css("top",toppos+"px")};getNewElementdesc=function(){var textdesc=$("#input-elem-search").val();if(removeetype){textdesc=textdesc.substr(2,textdesc.length-2);removeetype=false}return textdesc};
AppContext.cluster.addNewElement=function(elemId,desc,type){var elemObj={"elementId":elemId,"description":desc};AppContext.vizdata.addElement(elemObj);var datum={"value":elemId};AppContext.grid.addGridPos(null,datum,type);$("#addFromTypeahead").css("display","none")};getElement=function(id){var allElems=AppContext.vizdata.getElements();var elem="";$.each(allElems,function(i){if(this.elementId==id)elem=this});return elem};
AppContext.cluster.deleteElem=function(idToDel){var elemtodel=getElement(idToDel);var allpositions=AppContext.vizdata.getPositions();$.each(allpositions,function(i$$0,pos){if(pos.elementId==idToDel){AppContext.vizdata.removePosition(pos);var relations=AppContext.vizdata.getRelations();$.each(relations,function(i,relation){if(relation.srcPosId===pos.posId||relation.targetPosId===pos.posId)AppContext.vizdata.removeRelation(relation)});domElemToDel=$(pos.posId);domElemToDel.removeClass("stories");domElemToDel.removeClass("forces");
domElemToDel.removeClass("solutionComponents");domElemToDel.removeClass("new")}});AppContext.vizdata.removeElement(elemtodel)};AppContext.cluster.updateElem=function(idToEdit,newDesc){idToEdit=idToEdit.trim();var newElem={"elementId":idToEdit,"description":newDesc};var elemtodel=getElement(idToEdit);AppContext.vizdata.removeElement(elemtodel);AppContext.vizdata.addElement(newElem)};
function handleAddNewElement$$module$elementOperations(currentElementId,currentType,selectTab){selectTab.tab("show").css("text-decoration","underline");$("#input-elem-search").val("");$("#input-elem-search").fadeOut(2E3);$("#edit_input_container").prepend('<textarea row="3" id="newElementText" style="display: none;"></textarea>');$("#newElementText").fadeIn(1E3).focus();$("#newElementText").keypress(function(e){if(e.which===13){var newElementDesc=$("#newElementText").val();resetDescSection$$module$elementOperations();
if(AppContext.cluster.addNewElement!=""&&newElementDesc!=""){AppContext.cluster.addNewElement(currentElementId,newElementDesc,currentType);selectTab.css("text-decoration","");selectTab.parent().removeClass("active");return}}})}function resetDescSection$$module$elementOperations(){$("#newElementText").fadeOut(2E3);$("#newElementText").val("");$("#newElementText").remove();$("#input-elem-search").fadeIn(1E3).focus().val("")}
handleKeyPress=function(e){if(!e)e=window.event;var keyCode=e.keyCode||e.which;if(keyCode===32){var currentElementId="";var currentType="";var textContent=getNewElementdesc().toLowerCase().split(" ");if(textContent[0].length<2)if(textContent[0]=="s"){var idstr="S"+AppContext.global.generateUniqueId();currentType="stories";currentElementId=idstr;handleAddNewElement$$module$elementOperations(currentElementId,currentType,$("#elementsTab li:eq(0) a"));return}else if(textContent[0]=="f"){idstr="F"+AppContext.global.generateUniqueId();
currentType="forces";currentElementId=idstr;handleAddNewElement$$module$elementOperations(currentElementId,currentType,$("#elementsTab li:eq(1) a"));return}else if(textContent[0]=="c"){idstr="C"+AppContext.global.generateUniqueId();currentType="solutionComponents";currentElementId=idstr;handleAddNewElement$$module$elementOperations(currentElementId,currentType,$("#elementsTab li:eq(2) a"));return}else return;else displayOptions()}};
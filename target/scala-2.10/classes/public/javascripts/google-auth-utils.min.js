var module$google_auth_utils={};
var googleAppConf$$module$google_auth_utils=function(){if(window.location!=undefined){var browserURL=window.location+"";if(browserURL.indexOf("localhost")!=-1)return{clientId:"71045400673-s9agh1hpuunu5v2k46bkbpivdrvf8ibj.apps.googleusercontent.com",browserKey:"AIzaSyBYEmPSy44XpEXayCK9Xt8_vw_qKLFAkFs"};else if(browserURL.indexOf("emtool-staging.herokuapp")!=-1)return{clientId:"883917966367-h1np3jeqi9v00aku4ugphoh1f5939jnk.apps.googleusercontent.com",browserKey:"AIzaSyD7MkLjTksTUuovzbvMfXHMrYMh7EnYAz4"};else if(browserURL.indexOf("embodiedmaking.com")!=
-1)return{clientId:"306371176841-vkomb513h9hj2coj9301pgs9snsh9kdk.apps.googleusercontent.com",browserKey:"AIzaSyDbCHB5i1vFDi73J3Zxg5aDxQ-DWttdViI"};return{clientId:"",browserKey:""}}};var SCOPES$$module$google_auth_utils=["https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive.install","https://www.googleapis.com/auth/userinfo.profile","openid"];
function fetchClientDetails$$module$google_auth_utils(callback){Util.log.console("Handle Client Load");checkAuth$$module$google_auth_utils(callback)}function checkAuth$$module$google_auth_utils(callback){Util.log.console("Checking Authorization");if(gapi.auth!=undefined)gapi.auth.authorize({"client_id":googleAppConf$$module$google_auth_utils().clientId,"scope":SCOPES$$module$google_auth_utils.join(" "),"immediate":true},callback)}
function handleAuthResult$$module$google_auth_utils(file_state){var startAuthorization=function(authResult){if(authResult&&!authResult.error){var _this=this;gapi.client.load("oauth2","v2",function(resp){if(file_state=="old"){Util.log.console("Util something");gapi.load("picker",{"callback":createPicker});var picker=null;var createPicker=function(){picker=(new google.picker.PickerBuilder).addView((new google.picker.View(google.picker.ViewId.DOCS)).setQuery(".ema")).enableFeature(google.picker.Feature.NAV_HIDDEN).setDeveloperKey(developerKey).setCallback(pickerCallback).build();
picker.setVisible(true)};var pickerCallback=function(data){Util.log.console("Calling picker callback");var url="nothing";if(data[google.picker.Response.ACTION]==google.picker.Action.PICKED){var doc=data[google.picker.Response.DOCUMENTS][0];url=doc[google.picker.Document.URL]}if(url!="nothing")window.location.replace(url)}}else window.onload=AppContext.grid.loadApplication()})}else{$("body").append('<div id="authModal" class="modal hide fade auth_perm_modal" tabindex="-1" role="dialog" aria-labelledby="authModalLabel" aria-hidden="true"><div class="modal-header text-center"><h4 id="authModalLabel">Please Authorize The Embodied Making Tool for Saving your changes to <u>Your</u> Google Drive</h4></div><div class="modal-footer"><button class="btn btn-primary" aria-hidden="true" data-dismiss="modal" id="auth_em_btn">Authorize</button><button id="cancel_auth" class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button></div></div>');
$("#authModal").modal({show:true,keyboard:false});$("#auth_em_btn").click(function(){gapi.auth.init(function(){gapi.auth.authorize({client_id:googleAppConf$$module$google_auth_utils().clientId,scope:[rtclient.INSTALL_SCOPE,rtclient.FILE_SCOPE,rtclient.OPENID_SCOPE],user_id:undefined,immediate:true},startAuthorization)})})}};startAuthorization()}function refresh_Complete$$module$google_auth_utils(){}
function refreshComplete$$module$google_auth_utils(authResult){refresh_complete(authResult);window.setTimeout(refreshToken$$module$google_auth_utils,(authResult.expires_in-60)*1E3)}function refreshToken$$module$google_auth_utils(){checkAuth$$module$google_auth_utils(refreshComplete$$module$google_auth_utils)}
function getUserName$$module$google_auth_utils(authResult){Util.log.console("Fetching user name");if(authResult){Util.log.console("Authorized");window.setTimeout(refreshToken$$module$google_auth_utils,authResult.expires_in*1E3);setTimeout(AppContext.project.getUserInfo,1E4)}else Util.log.console("Not Authorized")};